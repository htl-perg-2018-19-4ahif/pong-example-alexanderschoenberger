{"version":3,"sources":["../src/client/socketio.ts"],"names":[],"mappings":"AACA,CAAC,CAAC;IAEA,MAAM,OAAO,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC;IAC1B,MAAM,cAAc,GAAG,CAAC,CAAC,gBAAgB,CAAC,CAAC;IAC3C,MAAM,UAAU,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;IACpC,MAAM,UAAU,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;IACpC,MAAM,SAAS,GAAG,CAAC,CAAC,iBAAiB,CAAC,CAAC;IACvC,MAAM,YAAY,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC;IAClC,MAAM,WAAW,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;IACrC,MAAM,WAAW,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;IACrC,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC;IACvB,MAAM,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC;IACzB,MAAM,WAAW,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;IACrC,MAAM,aAAa,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC;IACrC,MAAM,YAAY,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC;IACnC,MAAM,OAAO,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC;IAG7B,IAAI,UAAU,GAAW,CAAC,CAAC;IAC3B,IAAI,UAAU,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;IAEhD,UAAU,CAAC,IAAI,EAAE,CAAC;IAClB,SAAS,CAAC,IAAI,EAAE,CAAC;IACjB,aAAa,CAAC,IAAI,EAAE,CAAC;IACrB,YAAY,CAAC,IAAI,EAAE,CAAC;IASpB,IAAI,MAAe,CAAC;IAGpB,wEAAwE;IACxE,6EAA6E;IAC7E,MAAM,MAAM,GAAG,EAAE,EAAE,CAAC;IACd,MAAO,CAAC,QAAQ,GAAG,MAAM,CAAC;IAEhC,MAAM,IAAI,GAAqB,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;IAE/D,MAAM,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;IAE7C,OAAO,CAAC,OAAO,CAAC,UAAU,KAAK;QAC7B,IAAI,KAAK,CAAC,KAAK,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE;YACjC,SAAS,EAAE,CAAC;SACb;IACH,CAAC,CAAC,CAAC;IAEH,YAAY,CAAC,KAAK,CAAC;QACjB,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,eAAe,CAAC,YAAY,EAAE,QAAQ,CAAC,eAAe,CAAC,WAAW,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE,EAAE,UAAU,EAAE,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxP,CAAC,CAAC,CAAC;IAEH,OAAO,CAAC,KAAK,CAAC;QACZ,YAAY,CAAC,IAAI,EAAE,CAAC;QACpB,aAAa,CAAC,IAAI,EAAE,CAAC;QACrB,UAAU,CAAC,IAAI,EAAE,CAAC;IACpB,CAAC,CAAC,CAAC;IAEH,SAAS,SAAS;QAChB,MAAM,GAAG,EAAE,IAAI,EAAE,cAAc,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAA;QACpF,IAAI,MAAM,CAAC,IAAI,EAAE;YACT,MAAO,CAAC,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC;YACvC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;SAC9B;IACH,CAAC;IAID,qEAAqE;IACrE,MAAM,CAAC,EAAE,CAAC,eAAe,EAAE,UAAU,IAAI;QACvC,IAAI,IAAI,IAAI,CAAC,EAAE;YACb,UAAU,GAAG,CAAC,CAAC,CAAC;SACjB;QACD,UAAU,CAAC,IAAI,EAAE,CAAC;QAClB,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;QACzC,UAAU,CAAC,IAAI,EAAE,CAAC;IACpB,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,EAAE,CAAC,cAAc,EAAE;QACxB,UAAU,CAAC,IAAI,EAAE,CAAC;QAClB,SAAS,CAAC,IAAI,EAAE,CAAC;IACnB,CAAC,CAAC,CAAC;IAGH,MAAM,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE;QAC3B,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,GAAG,IAAI,CAAC;IAC/C,CAAC,CAAC,CAAC;IAGH,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;QACzB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC;QACnC,IAAI,CAAC,CAAC,KAAK,UAAU,EAAE;YACrB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC;SACtC;aAAM;YACL,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;SACrC;IACH,CAAC,CAAC,CAAC;IAGH,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;QAC5B,IAAI,CAAC,CAAC,KAAK,UAAU,EAAE;YACrB,CAAC,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC7B;aACI;YACH,CAAC,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC9B;IACH,CAAC,CAAC,CAAC;IAGH,MAAM,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,EAAE;QAC7B,IAAI,CAAC,CAAC,KAAK,UAAU,EAAE;YACrB,CAAC,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC9B;aAAM;YACL,CAAC,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC7B;IACH,CAAC,CAAC,CAAC;IAGH,MAAM,CAAC,EAAE,CAAC,UAAU,EAAE,GAAG,CAAC,EAAE;QAC1B,IAAI,OAAO,GAAG,GAAgB,CAAC;QAE/B,SAAS,CAAC,IAAI,EAAE,CAAC;QAEjB,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,EAAE;YACnC,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;gBACvC,YAAY,CAAC,IAAI,EAAE,CAAC;gBACpB,MAAM,CAAC,GAAG,EAAE,CAAC;gBACb,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aACvB;iBAAM;gBACL,aAAa,CAAC,IAAI,EAAE,CAAC;gBACrB,MAAM,CAAC,IAAI,EAAE,CAAC;gBACd,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aACzB;SACF;aAAM;YACL,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;gBACvC,YAAY,CAAC,IAAI,EAAE,CAAC;gBACpB,MAAM,CAAC,GAAG,EAAE,CAAC;gBACb,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aACvB;iBAAM;gBACL,aAAa,CAAC,IAAI,EAAE,CAAC;gBACrB,MAAM,CAAC,IAAI,EAAE,CAAC;gBACd,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aACzB;SACF;QACD,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC;IACnB,CAAC,CAAC,CAAC;AAEL,CAAC,CAAC,CAAC","file":"socketio.js","sourcesContent":["\r\n$(function () {\r\n\r\n  const $window = $(window);\r\n  const $usernameInput = $('.usernameInput');\r\n  const $loginPage = $('.login.page');\r\n  const $startPage = $('.start.page');\r\n  const $pongPage = $('.pong.gameboard');\r\n  const $startButton = $('.button');\r\n  const $startTitle = $('.starttitle');\r\n  const $playerName = $('.playername');\r\n  const $won = $('.won');\r\n  const $lost = $('.lost');\r\n  const $gameRounds = $('.gameRounds');\r\n  const $gameOverPage = $('.gameover');\r\n  const $victoryPage = $('.victory');\r\n  const $return = $('.return');\r\n\r\n\r\n  let ballRevert: number = 1;\r\n  let leftpaddle = $('.paddleLeft').offset().left;\r\n\r\n  $startPage.hide();\r\n  $pongPage.hide();\r\n  $gameOverPage.hide();\r\n  $victoryPage.hide();\r\n\r\n\r\n  interface IPlayer {\r\n    name: string;\r\n    score: number;\r\n    won: number;\r\n    lost: number;\r\n  }\r\n  let player: IPlayer;\r\n\r\n\r\n  // Establish connection with socket.io server. Note that this just works\r\n  // because `<script src=\"/socket.io/socket.io.js\"></script>` is in index.html\r\n  const socket = io();\r\n  (<any>window).mysocket = socket;\r\n\r\n  const keys = <HTMLUListElement>document.getElementById('keys');\r\n\r\n  const ball = document.getElementById('ball');\r\n\r\n  $window.keydown(function (event) {\r\n    if (event.which === 13 && !player) {\r\n      setPlayer();\r\n    }\r\n  });\r\n\r\n  $startButton.click(function () {\r\n    socket.emit('start game', document.documentElement.clientHeight, document.documentElement.clientWidth, $('#ball').outerHeight(true), $('#ball').outerWidth(true), $('.paddleLeft').width(), $('.paddleLeft').height(), leftpaddle, $gameRounds.val());\r\n  });\r\n\r\n  $return.click(function () {\r\n    $victoryPage.hide();\r\n    $gameOverPage.hide();\r\n    $startPage.show();\r\n  });\r\n\r\n  function setPlayer() {\r\n    player = { name: $usernameInput.val().toString().trim(), score: 0, won: 0, lost: 0 }\r\n    if (player.name) {\r\n      (<any>window).playerName = player.name;\r\n      socket.emit('login', player);\r\n    }\r\n  }\r\n\r\n\r\n\r\n  // Listeners --------------------------------------------------------\r\n  socket.on('login success', function (code) {\r\n    if (code == 2) {\r\n      ballRevert = -1;\r\n    }\r\n    $loginPage.hide();\r\n    $playerName.text(player.name.toString());\r\n    $startPage.show();\r\n  });\r\n\r\n  socket.on('game started', function () {\r\n    $startPage.hide();\r\n    $pongPage.show();\r\n  });\r\n\r\n\r\n  socket.on('ArrowKey', code => {\r\n    $('.paddleRight')[0].style.top = code + \"px\";\r\n  });\r\n\r\n\r\n  socket.on('ball', (x, y) => {\r\n    $('#ball')[0].style.top = `${y}px`;\r\n    if (-1 === ballRevert) {\r\n      $('#ball')[0].style.right = `${x}px`;\r\n    } else {\r\n      $('#ball')[0].style.left = `${x}px`;\r\n    }\r\n  });\r\n\r\n\r\n  socket.on('leftPoint', code => {\r\n    if (-1 === ballRevert) {\r\n      $('#pointsLeft').text(code);\r\n    }\r\n    else {\r\n      $('#pointsRight').text(code);\r\n    }\r\n  });\r\n\r\n\r\n  socket.on('rightPoint', code => {\r\n    if (-1 === ballRevert) {\r\n      $('#pointsRight').text(code);\r\n    } else {\r\n      $('#pointsLeft').text(code);\r\n    }\r\n  });\r\n\r\n\r\n  socket.on('gameover', val => {\r\n    let players = val as IPlayer[];\r\n\r\n    $pongPage.hide();\r\n\r\n    if (players[0].name === player.name) {\r\n      if (players[0].score > players[1].score) {\r\n        $victoryPage.show();\r\n        player.won++;\r\n        $won.text(player.won);\r\n      } else {\r\n        $gameOverPage.show();\r\n        player.lost++;\r\n        $lost.text(player.lost);\r\n      }\r\n    } else {\r\n      if (players[1].score > players[0].score) {\r\n        $victoryPage.show();\r\n        player.won++;\r\n        $won.text(player.won);\r\n      } else {\r\n        $gameOverPage.show();\r\n        player.lost++;\r\n        $lost.text(player.lost);\r\n      }\r\n    }\r\n    player.score = 0;\r\n  });\r\n\r\n});\r\n\r\n\r\n"]}